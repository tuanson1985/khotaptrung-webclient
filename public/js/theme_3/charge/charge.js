$(document).ready((function(){function a(a){return a.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1.")}function t(t){$.ajax({type:"GET",url:"/ajax/get-amount-tele-card",data:{telecom:t},beforeSend:function(a){$(".amount-loading").removeClass("d-none"),$("#amount").addClass("d-none"),$("#amount_mobile").addClass("d-none")},success:function(t){if($(".amount-loading").addClass("d-none"),1==t.status){$("#amount").removeClass("d-none"),$("#amount_mobile").removeClass("d-none");var e="";t.data.length>0&&$.each(t.data,(function(t,n){e+='<div class=" col-4 col-md-4 pl-fix-4 pr-fix-4 check-radio-form charge-card-form">',e+=0==t?'<input  name="amount" type="radio" id="recharge_amount_'+t+'" data-ratito="'+n.ratio_true_amount+'" value="'+n.amount+'"  hidden checked>':'<input  name="amount" type="radio" id="recharge_amount_'+t+'" data-ratito="'+n.ratio_true_amount+'" value="'+n.amount+'" hidden>',e+='<label for="recharge_amount_'+t+'">',e+="<p>"+a(n.amount)+"đ</p>",e+=" </label>",e+="  </div>"})),$(window).width()>992?$("#amount").html(e):$("#amount_mobile").html(e),amount_checked=$("input[name=amount]:checked"),function(){var a=amount_checked.val(),t=amount_checked.attr("data-ratito");(t<=0||""==t||null==t)&&(t=100);var e=a-a*t/100,n=a-e,o=a;0!=e?$(".charge_total").html("<span>"+n.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")+"đ</span>"):$(".charge_total").html("<span>"+o.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")+"đ</span>"),$("input[name=amount]").change((function(){var a=$(this).val(),t=$(this).attr("data-ratito");(t<=0||""==t||null==t)&&(t=100);var e=a-a*t/100,n=a-e,o=a;0!=e?$(".charge_total").html("<span>"+n.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")+"đ</span>"):$(".charge_total").html("<span>"+o.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")+"đ</span>")}))}(),$(".charge_amount").html(" <small>"+a(amount_checked.val())+"</small>"),$(".charge_price").html(" <span>"+a(amount_checked.val())+"</span>"),$(".charge_ratito").html(" <small>"+a(amount_checked.attr("data-ratito"))+"</small>"),$("input[name=amount]").change((function(){$(".charge_amount").html(" <small>"+a($(this).val())+"</small>"),$(".charge_price").html(" <span>"+a($(this).val())+"</span>"),$(".charge_ratito").html(" <small>"+a($(this).attr("data-ratito"))+"</small>")})),$.ajax({type:"GET",url:"/reload-captcha",success:function(a){$(".captcha_1 span").html(a.captcha)}})}else console.log("Có lỗi xảy ra ("+t.message+")")},error:function(a){console.log("Có lỗi phát sinh vui lòng liên hệ QTV để kịp thời xử lý.(getAmount)")},complete:function(a){}})}$("#reload_1").click((function(){$(".refresh-captcha img").toggleClass("down"),$.ajax({type:"GET",url:"reload-captcha2",success:function(a){$(".captcha_1 span").html(a)}})})),$(".charge_name").html(" <small>"+telecom+"</small>"),$("body").on("change","#telecom",(function(){var a=$(this).val();$(".charge_name").html(" <small>"+a+"</small>"),$(".charge_amount").html(""),$(".charge_price").html(""),$(".charge_ratito").html(""),t(a)}));var e,n,o,c,r,l=$("#form-charge2"),i=l.attr("action"),h=l.find(":submit"),s=$(window).width();function m(){$.ajax({type:"POST",url:i,cache:!1,data:l.serialize(),beforeSend:function(a){},success:function(a){$("#openCharge").modal("hide"),1==a.status?($("#successChargeModal").modal("show"),$("#success_charge").html(a.message)):401==a.status?window.location.href="/login?return_url="+window.location.href:0==a.status?($("#rejectChargeModal").modal("show"),$("#reject_charge").html(a.message)):console.log("Có lỗi xảy ra ("+a.message+")")},error:function(a){console.log("Có lỗi phát sinh vui lòng liên hệ QTV để kịp thời xử lý. (post charge)")},complete:function(a){$("#reload_1").trigger("click"),l.trigger("reset"),h.text("Nạp thẻ"),h.prop("disabled",!1),$(".btn-confirm-charge").text("Xác nhận"),$(".btn-confirm-charge").prop("disabled",!1)}})}l.submit((function(a){if(a.preventDefault(),a.stopPropagation(),s<992){if(r)return!1;r=!0,e=$("#fieldset-one_transaction"),(n=$("#fieldset-two-charge")).show(),e.animate({opacity:0},{step:function(a,t){o=50*a+"%",c=1-a,n.css({left:o,opacity:c})},complete:function(){e.hide(),r=!1},easing:"easeInOutBack"})}else $("#openCharge").modal("show")})),$(".btn-confirm-charge").on("click",(function(a){return h.text("Đang xử lý..."),h.prop("disabled",!0),$(".btn-confirm-charge").text("Đang xử lý..."),$(".btn-confirm-charge").prop("disabled",!0),m(),!1})),$("#nav_charge").click((function(){var a="".concat(window.location.origin,"/nap-the");window.history.pushState("charge_card","",a),$("#charge_title").text("Nạp thẻ cào")})),$("#nav_charge_atm").click((function(){var a="".concat(window.location.origin,"/recharge-atm");window.history.pushState("charge_card","",a),$("#charge_title").text("ATM tự động")}))}));