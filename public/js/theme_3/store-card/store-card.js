$(document).ready((function(){var e=new Swiper(".slider--card",{slidesPerView:1,spaceBetween:16,freeMode:!0,observer:!0,observeParents:!0}),a=(new Swiper(".slider--card__telecom",{slidesPerView:2.5,spaceBetween:8,freeMode:!0,observer:!0,observeParents:!0}),new Swiper(".slider--card__amount",{slidesPerView:2.5,spaceBetween:8,freeMode:!0,observer:!0,observeParents:!0}),{amount:0,telecom:"",quantity:0,_token:$('meta[name="csrf-token"]').attr("content")});function t(e){return e.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1.")}function n(e){$.ajax({url:"/ajax/store-card/get-amount",type:"GET",data:{telecom:e},beforeSend:function(){$(".denos--wrap").addClass("d-none"),$("#amountWidget .loader").removeClass("d-none")},success:function(e){if(e.status){let a=e.data,n=0;$("#cardAmountList").empty(),$("#cardAmountListMobile").empty(),a.length?(a.forEach((function(e){if($(window).width()>992){let a="";a+='<li class="deno__item col-4 col-lg-4">',a+=0===n?`<input type="radio" id="amount-${e.id}" value="${e.amount}" data-discount="${e.ratio_default}" name="card-value" checked hidden>`:`<input type="radio" id="amount-${e.id}" value="${e.amount}" data-discount="${e.ratio_default}" name="card-value" hidden>`,a+=`<label for="amount-${e.id}" class="deno__value card-item-value">`,a+=`<span>${t(e.amount)} đ</span>`,a+="</label>",a+="</li>",n++,$("#cardAmountList").append(a)}else{let a="";a+='<div class="swiper-slide">',a+='<div class="deno__item ">',a+=0===n?`<input type="radio" id="amount-${e.id}" value="${e.amount}" data-discount="${e.ratio_default}" name="card-value" checked hidden>`:`<input type="radio" id="amount-${e.id}" value="${e.amount}" data-discount="${e.ratio_default}" name="card-value" hidden>`,a+=`<label for="amount-${e.id}" class="deno__value card-item-value">`,a+=`<span>${t(e.amount)} đ</span>`,a+="</label>",a+="</div>",a+="</div>",n++,$("#cardAmountListMobile").append(a)}})),$('input[name="card-amount"]').val(1),i(),$('input[name="card-value"]').change((function(e){e.preventDefault(),i()})),$('input[name="card-amount"]').on("input",(function(e){e.preventDefault(),i()})),$("#btn-confirm").prop("disabled",!1)):($(window).width()>992?$("#cardAmountList").append('<p class="text-center c-mb-0">Chưa có mệnh giá của thẻ</p>'):$("#cardAmountListMobile").append('<p class="text-center c-mb-0">Chưa có mệnh giá của thẻ</p>'),$(".discount--value").text("0%"),$(".price--total__value").text("0 đ"),$("#btn-confirm").prop("disabled",!0)),$(".denos--wrap").removeClass("d-none")}},complete:function(){$("#amountWidget .loader").addClass("d-none")}})}function i(){let e=$('input[name="card-value"]:checked').data("discount");$('input[name="card-discount"]').val(e),isNaN(100-e)?$(".discount--value").text("0%"):$(".discount--value").text(100-e+"%"),isNaN(c())?$(".price--total__value").text("0 đ"):$(".price--total__value").text(`${t(c())} đ`)}function c(){let e=$('input[name="card-value"]:checked').val(),a=$('input[name="card-amount"]').val(),t=e-e*$('input[name="card-discount"]').val()/100;return t?(e-t)*a:e*a}$("#btn-confirm").on("click",(function(e){e.preventDefault(),$("#modal--confirm__payment #confirmPrice").text(""),$("#modal--confirm__payment #confirmQuantity").text(""),$("#modal--confirm__payment #confirmDiscount").text(""),$("#modal--confirm__payment #confirmTotal").text(""),$("#modal--confirm__payment #totalBill").text(""),function(){let e=$('input[name="card-type"]:checked').data("img"),a=$('input[name="card-value"]:checked').val(),n=$('input[name="card-amount"]').val(),i=$('input[name="card-value"]:checked').data("discount");$("#modal--confirm__payment #confirmCard").attr("src",e),$("#modal--confirm__payment #confirmPrice").text(`${t(a)} đ`),$("#modal--confirm__payment #confirmQuantity").text(n),$("#modal--confirm__payment #confirmDiscount").text(100-i+"%"),$("#modal--confirm__payment #confirmTotal").text(`${t(c())} đ`),$("#modal--confirm__payment #totalBill").text(`${t(c())} đ`)}(),function(){let e=$('input[name="card-value"]:checked').val(),t=$('input[name="card-type"]:checked').val(),n=$('input[name="card-amount"]').val();a.amount=e,a.telecom=t.toUpperCase(),a.quantity=n}()})),$("#modal--confirm__payment #confirmSubmitButton").on("click",(function(n){n.preventDefault(),$.ajax({url:"/ajax/mua-the",type:"POST",data:a,beforeSend:function(){$("#confirmSubmitButton").prop("disabled",!0),$("#confirmSubmitButton").text("Đang xử lý"),$("#modal--success__payment .card__message").text(""),$("#modal--success__payment #successPrice").text(""),$("#modal--success__payment #successQuantity").text(""),$("#modal--success__payment .swiper-wrapper").empty(),e.update()},success:function(n){if($("#modal--confirm__payment").modal("hide"),n.status&&401!==n.status){let i=n.data,c=$('input[name="card-type"]:checked').data("img"),d=$('input[name="card-type"]:checked').val();$("#modal--success__payment .card__message").text(n.message),$("#modal--success__payment #successCard").attr("src",c),$("#modal--success__payment #successPrice").text(t(a.amount)+" đ"),$("#modal--success__payment #successQuantity").text(a.quantity),i.data_card.length>0&&(i.data_card.forEach((function(e){let n="";n+='<div class="swiper-slide card__detail">',n+='  <div class="card--header__detail">',n+='      <div class="card--info__wrap">',n+='          <div class="card--logo">',n+=`            <img src="${c}" alt="telecom_logo">`,n+="          </div>",n+='          <div class="card--info">',n+='              <div class="card--info__name">',n+=`                  ${d}`,n+="              </div>",n+='               <div class="card--info__value">',n+=`                    ${t(a.amount)} đ`,n+="                </div>",n+="            </div>",n+="        </div>",n+="    </div>",n+='    <div class="card--gray">',n+='      <div class="card--attr">',n+='            <div class="card--attr__name">',n+="              Mã thẻ",n+="            </div>",n+='            <div class="card--attr__value">',n+='              <div class="card__info">',n+=`                  ${e.pin}`,n+="               </div>",n+='               <div class="icon--coppy js-copy-text">',n+='                    <img src="/assets/frontend/theme_3/image/icons/coppy.png" alt="icon__copy">',n+="                </div>",n+="            </div>",n+="        </div>",n+='        <div class="card--attr">',n+='             <div class="card--attr__name">',n+="                 Số Series",n+="              </div>",n+='              <div class="card--attr__value">',n+='                  <div class="card__info">',n+=`                      ${e.serial}`,n+="                   </div>",n+='                   <div class="icon--coppy js-copy-text">',n+='                      <img src="/assets/frontend/theme_3/image/icons/coppy.png" alt="icon__copy">',n+="                   </div>",n+="               </div>",n+="         </div>",n+="    </div>",n+="</div>",$("#modal--success__payment .swiper-wrapper").append(n)})),tippy(".js-copy-text",{trigger:"click",content:"Đã coppy !",placement:"right"})),i.length>1?e.params.slidesPerView=1.25:e.params.slidesPerView=1,e.update(),$("#modal--success__payment").modal("show")}else $("#message--error--buy").text(n.message),$("#modal--fail__payment").modal("show")},error:function(e){$("#message--error--buy").text(""),$("#modal--fail__payment").modal("show")},complete:function(){$("#confirmSubmitButton").prop("disabled",!1),$("#confirmSubmitButton").text("Xác nhận")}}),$("#modal--confirm__payment").modal("hide")})),$("input[numberic]").on("keypress",(function(e){if(isNaN(this.value+String.fromCharCode(e.keyCode)))return!1})),$("input.input--amount").on("input",(function(){$(this).val()>20&&$(this).val(20)})),$(".js-amount").on("click",(function(){let e=$(this).parent().find("input.input--amount"),a=e.val();"add"===$(this).data("action")&&e.val(++a),"minus"===$(this).data("action")&&a>1&&e.val(--a),e.val()>20&&e.val(20),$("input[name=card-amount]").trigger("input")})),n($('input[name="card-type"]').val()),$('input[name="card-type"]').change((function(e){e.preventDefault(),n($(this).val())})),n($('input[name="card-type-mobile"]').val()),$('input[name="card-type-mobile"]').change((function(e){e.preventDefault(),n($(this).val())})),$(".section--amount__card").removeClass("d-none")})),$(document).ready((function(){$.ajax({url:"/ajax/store-card/get-telecom",type:"GET",success:function(e){if(e.status){let a=e.data,t=0;a.forEach((function(e){if($(window).width()>992){let a="";a+='<li class="cards__item col-4 col-lg-2 p_0">',a+=0===t?`<input type="radio" id="card-${e.id}" value="${e.key}" data-img="${e.image}" name="card-type" checked hidden>`:`<input type="radio" id="card-${e.id}" value="${e.key}" data-img="${e.image}" name="card-type" hidden>`,a+=`<label for="card-${e.id}">`,a+=`<img src="${e.image}" class="card--logo" alt="${e.title}">`,a+="</label>",a+="</li>",t++,e.params&&e.params.teltecom_type?(2==e.params.teltecom_type&&$("#cardGameList").append(a),1==e.params.teltecom_type&&$("#cardPhoneList").append(a)):$("#cardPhoneList").append(a)}else{let a="";a+='<div class="swiper-slide">',a+='<div class="cards__item  w-100">',a+=0===t?`<input type="radio" id="card-${e.id}" value="${e.key}" data-img="${e.image}" name="card-type" checked hidden>`:`<input type="radio" id="card-${e.id}" value="${e.key}" data-img="${e.image}" name="card-type" hidden>`,a+=`<label for="card-${e.id}">`,a+=`<img src="${e.image}" class="card--logo" alt="${e.title}">`,a+="</label>",a+="</div>",a+="</div>",t++,e.params&&e.params.teltecom_type?(2==e.params.teltecom_type&&$("#cardGameListMobile").append(a),1==e.params.teltecom_type&&$("#cardPhoneListMobile").append(a)):$("#cardPhoneListMobile").append(html)}})),n($('input[name="card-type"]').val()),$('input[name="card-type"]').change((function(e){e.preventDefault(),n($(this).val())})),$(".section--amount__card").removeClass("d-none")}},error:function(){console.log("Đã xảy ra lỗi khi load dữ liệu! Vui lòng load lại trang! (getListCard storecard)")},complete:function(){$("#cardGameList .loader").addClass("d-none")}});var e=new Swiper(".slider--card",{slidesPerView:1,spaceBetween:16,freeMode:!0,observer:!0,observeParents:!0}),a=(new Swiper(".slider--card__telecom",{slidesPerView:2.5,spaceBetween:8,freeMode:!0,observer:!0,observeParents:!0}),new Swiper(".slider--card__amount",{slidesPerView:2.5,spaceBetween:8,freeMode:!0,observer:!0,observeParents:!0}),{amount:0,telecom:"",quantity:0,_token:$('meta[name="csrf-token"]').attr("content")});function t(e){return e.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1.")}function n(e){$.ajax({url:"/ajax/store-card/get-amount",type:"GET",data:{telecom:e},beforeSend:function(){$(".denos--wrap").addClass("d-none"),$("#amountWidget .loader").removeClass("d-none")},success:function(e){if(e.status){let a=e.data,n=0;$("#cardAmountList").empty(),a.length?(a.forEach((function(e){let a="";a+='<li class="deno__item col-4 col-lg-4">',a+=0===n?`<input type="radio" id="amount-${e.id}" value="${e.amount}" data-discount="${e.ratio_default}" name="card-value" checked hidden>`:`<input type="radio" id="amount-${e.id}" value="${e.amount}" data-discount="${e.ratio_default}" name="card-value" hidden>`,a+=`<label for="amount-${e.id}" class="deno__value">`,a+=`<span>${t(e.amount)} đ</span>`,a+="</label>",a+="</li>",n++,$("#cardAmountList").append(a)})),$('input[name="card-amount"]').val(1),i(),$('input[name="card-value"]').change((function(e){e.preventDefault(),i()})),$('input[name="card-amount"]').on("input",(function(e){e.preventDefault(),i()})),$("#btn-confirm").prop("disabled",!1)):($("#cardAmountList").append('<p class="text-center c-mb-0">Chưa có mệnh giá của thẻ</p>'),$(".discount--value").text("0%"),$(".price--total__value").text("0 đ"),$("#btn-confirm").prop("disabled",!0)),$(".denos--wrap").removeClass("d-none")}},complete:function(){$("#amountWidget .loader").addClass("d-none")}})}function i(){let e=$('input[name="card-value"]:checked').data("discount");$('input[name="card-discount"]').val(e),isNaN(100-e)?$(".discount--value").text("0%"):$(".discount--value").text(100-e+"%"),isNaN(c())?$(".price--total__value").text("0 đ"):$(".price--total__value").text(`${t(c())} đ`)}function c(){let e=$('input[name="card-value"]:checked').val(),a=$('input[name="card-amount"]').val(),t=e-e*$('input[name="card-discount"]').val()/100;return t?(e-t)*a:e*a}$("#btn-confirm").on("click",(function(e){e.preventDefault(),$("#modal--confirm__payment #confirmPrice").text(""),$("#modal--confirm__payment #confirmQuantity").text(""),$("#modal--confirm__payment #confirmDiscount").text(""),$("#modal--confirm__payment #confirmTotal").text(""),$("#modal--confirm__payment #totalBill").text(""),function(){let e=$('input[name="card-type"]:checked').data("img"),a=$('input[name="card-value"]:checked').val(),n=$('input[name="card-amount"]').val(),i=$('input[name="card-value"]:checked').data("discount");$("#modal--confirm__payment #confirmCard").attr("src",e),$("#modal--confirm__payment #confirmPrice").text(`${t(a)} đ`),$("#modal--confirm__payment #confirmQuantity").text(n),$("#modal--confirm__payment #confirmDiscount").text(100-i+"%"),$("#modal--confirm__payment #confirmTotal").text(`${t(c())} đ`),$("#modal--confirm__payment #totalBill").text(`${t(c())} đ`)}(),$("#confirmMobileCard").empty(),$("#confirmMobilePrice").text(""),$("#confirmMobileQuantity").text(""),$("#confirmMobileDiscount").text(""),$("#confirmMobileTotal").text(""),$("#totalMobileBill").text(""),function(){let e=$('input[name="card-type"]:checked').data("img"),a=$('input[name="card-value"]:checked').val(),n=$('input[name="card-amount"]').val(),i=$('input[name="card-value"]:checked').data("discount");console.log(e,a,n,i),$("#confirmMobileCard").attr("src",e),$("#confirmMobilePrice").text(`${t(a)} đ`),$("#confirmMobileQuantity").text(n),$("#confirmMobileDiscount").text(100-i+"%"),$("#confirmMobileTotal").text(`${t(c())} đ`),$("#totalMobileBill").text(`${t(c())} đ`)}(),function(){let e=$('input[name="card-value"]:checked').val(),t=$('input[name="card-type"]:checked').val(),n=$('input[name="card-amount"]').val();a.amount=e,a.telecom=t.toUpperCase(),a.quantity=n}()})),$(document).on("click","#modal--confirm__payment #confirmSubmitButton",(function(n){n.preventDefault(),$.ajax({url:"/ajax/mua-the",type:"POST",data:a,beforeSend:function(){$("#confirmSubmitButton").prop("disabled",!0),$("#confirmSubmitButton").text("Đang xử lý"),$("#modal--success__payment .card__message").text(""),$("#modal--success__payment #successPrice").text(""),$("#modal--success__payment #successQuantity").text(""),$("#modal--success__payment .swiper-wrapper").empty(),e.update()},success:function(n){if($("#modal--confirm__payment").modal("hide"),n.status&&401!=n.status){let i=n.data,c=$('input[name="card-type"]:checked').data("img"),d=$('input[name="card-type"]:checked').val();$("#modal--success__payment .card__message").text(n.message),$("#modal--success__payment #successCard").attr("src",c),$("#modal--success__payment #successPrice").text(t(a.amount)+" đ"),$("#modal--success__payment #successQuantity").text(a.quantity),i.length>0&&i.forEach((function(e){let n="";n+='<div class="swiper-slide card__detail">',n+='  <div class="card--header__detail">',n+='      <div class="card--info__wrap">',n+='          <div class="card--logo">',n+=`            <img src="${c}" alt="telecom_logo">`,n+="          </div>",n+='          <div class="card--info">',n+='              <div class="card--info__name">',n+=`                  ${d}`,n+="              </div>",n+='               <div class="card--info__value">',n+=`                    ${t(a.amount)} đ`,n+="                </div>",n+="            </div>",n+="        </div>",n+="    </div>",n+='    <div class="card--gray">',n+='      <div class="card--attr">',n+='            <div class="card--attr__name">',n+="              Mã thẻ",n+="            </div>",n+='            <div class="card--attr__value">',n+='              <div class="card__info">',n+=`                  ${e.pin}`,n+="               </div>",n+='               <div class="icon--coppy js-copy-text">',n+='                    <img src="/assets/frontend/theme_3/image/icons/coppy.png" alt="icon__copy">',n+="                </div>",n+="            </div>",n+="        </div>",n+='        <div class="card--attr">',n+='             <div class="card--attr__name">',n+="                 Số Series",n+="              </div>",n+='              <div class="card--attr__value">',n+='                  <div class="card__info">',n+=`                      ${e.serial}`,n+="                   </div>",n+='                   <div class="icon--coppy js-copy-text">',n+='                      <img src="/assets/frontend/theme_3/image/icons/coppy.png" alt="icon__copy">',n+="                   </div>",n+="               </div>",n+="         </div>",n+="    </div>",n+="</div>",$("#modal--success__payment .swiper-wrapper").append(n)})),i.length>1?e.params.slidesPerView=1.25:e.params.slidesPerView=1,e.update(),$("#modal--success__payment").modal("show")}else $("#message--error--buy").text(n.message),$("#modal--fail__payment").modal("show")},error:function(e){$("#message--error--buy").text(""),$("#modal--fail__payment").modal("show")},complete:function(){$("#confirmSubmitButton").prop("disabled",!1),$("#confirmSubmitButton").text("Xác nhận")}}),$("#modal--confirm__payment").modal("hide")})),$("#confirmMobileButton").on("click",(function(e){e.preventDefault(),$.ajax({url:"/ajax/mua-the",type:"POST",data:a,beforeSend:function(){$("#confirmMobileButton").prop("disabled",!0),$("#confirmMobileButton").text("Đang xử lý"),$("#mobile--success__payment .card__message").text(""),$("#mobile--success__payment .card--list").empty()},success:function(e){if(e.status&&401!=e.status){let n=e.data,i=$('input[name="card-type"]:checked').data("img"),c=$('input[name="card-type"]:checked').val();$("#modal--success__payment .card__message").text(e.message),$("#modal--success__payment #successCard").attr("src",i),$("#modal--success__payment #successPrice").text(t(a.amount)+" đ"),$("#modal--success__payment #successQuantity").text(a.quantity),n.length>0&&n.forEach((function(e){let n="";n+='<div class="card__detail">',n+='<div class="card--header__detail">',n+='<div class="card--info__wrap">',n+='<div class="card--logo">',n+=`<img src="${i}" alt="">`,n+="</div>",n+='<div class="card--info">',n+='<div class="card--info__name">',n+=`${c}`,n+="</div>",n+='<div class="card--info__value">',n+=` ${t(a.amount)} đ`,n+="</div>",n+="</div>",n+="</div>",n+="</div>",n+='<div class="card--gray">',n+='<div class="card--attr">',n+='<div class="card--attr__name">',n+="Mã thẻ",n+="</div>",n+='<div class="card--attr__value -bold">',n+='<div class="card__info">',n+=`${e.pin}`,n+="</div>",n+='<div class="icon--coppy js-copy-text">',n+='<img src="/assets/frontend/theme_3/image/icons/coppy.png" alt="">',n+="</div>",n+="</div>",n+="</div>",n+='<div class="card--attr">',n+='<div class="card--attr__name">',n+="Seri",n+="</div>",n+='<div class="card--attr__value -bold">',n+='<div class="card__info">',n+=`${e.pin}`,n+="</div>",n+='<div class="icon--coppy js-copy-text">',n+='<img src="/assets/frontend/theme_3/image/icons/coppy.png" alt="">',n+="</div>",n+="</div>",n+="</div>",n+="</div>",n+="</div>",$("#mobile--success__payment .card--list").append(n)})),$(".mobile--confirm__payment").hide(),$(".mobile--success__payment").show()}else $("#message--error--buy").text(e.message),$("#modal--fail__payment").modal("show")},error:function(e){$("#message--error--buy").text(""),$("#modal--fail__payment").modal("show")},complete:function(){$("#confirmMobileButton").prop("disabled",!1),$("#confirmMobileButton").text("Xác nhận")}})}))}));
